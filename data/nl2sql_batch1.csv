id,question,sql
1,"Show all orders with their order id, user id and total quantity.","SELECT order_id, user_id, quantity FROM orders;"
2,"List all products with their name, category and price.","SELECT name, category, price FROM products;"
3,Which products are in the 'Electronics' category?,"SELECT product_id, name, price FROM products WHERE category = 'Electronics';"
4,Show the top 5 most expensive products.,"SELECT product_id, name, price FROM products ORDER BY price DESC LIMIT 5;"
5,Find all orders placed after 2024-01-01.,"SELECT order_id, user_id, product_id, quantity, order_date FROM orders WHERE order_date > '2024-01-01';"
6,How many orders has each user placed?,"SELECT user_id, COUNT(*) AS num_orders FROM orders GROUP BY user_id;"
7,Show the total revenue per product.,"SELECT p.product_id, p.name, SUM(o.quantity * p.price) AS total_revenue FROM orders o JOIN products p ON o.product_id = p.product_id GROUP BY p.product_id, p.name;"
8,Which users are from the United States?,"SELECT user_id, name, email FROM users WHERE country = 'United States';"
9,Show all pending orders.,"SELECT order_id, user_id, product_id, quantity, status FROM orders WHERE status = 'PENDING';"
10,List the total quantity ordered for each product.,"SELECT product_id, SUM(quantity) AS total_quantity FROM orders GROUP BY product_id;"
11,Which product has the highest total quantity ordered?,"SELECT product_id, SUM(quantity) AS total_quantity FROM orders GROUP BY product_id ORDER BY total_quantity DESC LIMIT 1;"
12,Show users who signed up in 2024.,"SELECT user_id, name, email, signup_date FROM users WHERE signup_date >= '2024-01-01' AND signup_date < '2025-01-01';"
13,Show the average order quantity per user.,"SELECT user_id, AVG(quantity) AS avg_quantity FROM orders GROUP BY user_id;"
14,Which orders have a quantity greater than 3 items?,"SELECT order_id, user_id, product_id, quantity FROM orders WHERE quantity > 3;"
15,Show the total revenue per user.,"SELECT u.user_id, u.name, SUM(o.quantity * p.price) AS total_revenue FROM users u JOIN orders o ON u.user_id = o.user_id JOIN products p ON o.product_id = p.product_id GROUP BY u.user_id, u.name;"
16,Which users have never placed an order?,"SELECT u.user_id, u.name FROM users u LEFT JOIN orders o ON u.user_id = o.user_id WHERE o.order_id IS NULL;"
17,List all products that have never been ordered.,"SELECT p.product_id, p.name FROM products p LEFT JOIN orders o ON p.product_id = o.product_id WHERE o.order_id IS NULL;"
18,Show the total revenue of all completed orders.,SELECT SUM(o.quantity * p.price) AS total_revenue FROM orders o JOIN products p ON o.product_id = p.product_id WHERE o.status = 'COMPLETED';
19,"For each country, show how many users are registered.","SELECT country, COUNT(*) AS num_users FROM users GROUP BY country;"
20,"For each payment method, show the total amount paid.","SELECT payment_method, SUM(amount) AS total_amount FROM payments GROUP BY payment_method;"
