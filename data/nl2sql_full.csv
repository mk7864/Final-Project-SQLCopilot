id,question,sql
1,Show all users.,SELECT * FROM users;
2,Show all products.,SELECT * FROM products;
3,Show all orders.,SELECT * FROM orders;
4,Show all payments.,SELECT * FROM payments;
5,List all user names and emails.,"SELECT name, email FROM users;"
6,List every product name and its price.,"SELECT name, price FROM products;"
7,"Show order id, user id and product id for every order.","SELECT order_id, user_id, product_id FROM orders;"
8,Show each payment id with its order id and amount.,"SELECT payment_id, order_id, amount FROM payments;"
9,Which users are from the United States?,"SELECT user_id, name, email FROM users WHERE country = 'United States';"
10,Show all users from India.,"SELECT user_id, name, email FROM users WHERE country = 'India';"
11,Show products in the Electronics category.,"SELECT product_id, name, price FROM products WHERE category = 'Electronics';"
12,Show products that cost more than 100.,"SELECT product_id, name, price FROM products WHERE price > 100;"
13,Show products that cost less than 20.,"SELECT product_id, name, price FROM products WHERE price < 20;"
14,Show orders placed after 2024-01-01.,"SELECT order_id, user_id, product_id, quantity, order_date FROM orders WHERE order_date > '2024-01-01';"
15,Show orders placed in 2023.,"SELECT order_id, user_id, product_id, quantity, order_date FROM orders WHERE order_date BETWEEN '2023-01-01' AND '2023-12-31';"
16,Show completed orders only.,"SELECT order_id, user_id, product_id, quantity, status FROM orders WHERE status = 'COMPLETED';"
17,Show pending orders only.,"SELECT order_id, user_id, product_id, quantity, status FROM orders WHERE status = 'PENDING';"
18,How many users are registered in total?,SELECT COUNT(*) AS total_users FROM users;
19,How many orders have been placed in total?,SELECT COUNT(*) AS total_orders FROM orders;
20,Show the total quantity ordered for each product.,"SELECT product_id, SUM(quantity) AS total_quantity FROM orders GROUP BY product_id;"
21,Which product has the highest total quantity ordered?,"SELECT product_id, SUM(quantity) AS total_quantity FROM orders GROUP BY product_id ORDER BY total_quantity DESC LIMIT 1;"
22,Show the total revenue per product.,"SELECT p.product_id, p.name, SUM(o.quantity * p.price) AS total_revenue FROM orders o JOIN products p ON o.product_id = p.product_id GROUP BY p.product_id, p.name;"
23,Show the total revenue across all completed orders.,SELECT SUM(o.quantity * p.price) AS total_revenue FROM orders o JOIN products p ON o.product_id = p.product_id WHERE o.status = 'COMPLETED';
24,Show the average order quantity per user.,"SELECT user_id, AVG(quantity) AS avg_quantity FROM orders GROUP BY user_id;"
25,Show the minimum and maximum product price.,"SELECT MIN(price) AS min_price, MAX(price) AS max_price FROM products;"
26,"For each country, show how many users are registered.","SELECT country, COUNT(*) AS num_users FROM users GROUP BY country;"
27,"For each payment method, show the total amount paid.","SELECT payment_method, SUM(amount) AS total_amount FROM payments GROUP BY payment_method;"
28,"For each order status, show how many orders there are.","SELECT status, COUNT(*) AS num_orders FROM orders GROUP BY status;"
29,Show each order with the user name and product name.,"SELECT o.order_id, u.name AS user_name, p.name AS product_name, o.quantity, o.order_date FROM orders o JOIN users u ON o.user_id = u.user_id JOIN products p ON o.product_id = p.product_id;"
30,Show all completed orders with user name and payment amount.,"SELECT o.order_id, u.name AS user_name, pay.amount, pay.payment_date FROM orders o JOIN users u ON o.user_id = u.user_id JOIN payments pay ON o.order_id = pay.order_id WHERE o.status = 'COMPLETED';"
31,Show each payment with the corresponding user name and product name.,"SELECT pay.payment_id, u.name AS user_name, p.name AS product_name, pay.amount FROM payments pay JOIN orders o ON pay.order_id = o.order_id JOIN users u ON o.user_id = u.user_id JOIN products p ON o.product_id = p.product_id;"
32,Show the total revenue per user.,"SELECT u.user_id, u.name, SUM(o.quantity * p.price) AS total_revenue FROM users u JOIN orders o ON u.user_id = o.user_id JOIN products p ON o.product_id = p.product_id GROUP BY u.user_id, u.name;"
33,Show the total number of orders and total quantity per user.,"SELECT u.user_id, u.name, COUNT(o.order_id) AS num_orders, SUM(o.quantity) AS total_quantity FROM users u JOIN orders o ON u.user_id = o.user_id GROUP BY u.user_id, u.name;"
34,Which users have never placed an order?,"SELECT u.user_id, u.name FROM users u LEFT JOIN orders o ON u.user_id = o.user_id WHERE o.order_id IS NULL;"
35,List all products that have never been ordered.,"SELECT p.product_id, p.name FROM products p LEFT JOIN orders o ON p.product_id = o.product_id WHERE o.order_id IS NULL;"
36,Show users who have placed more than 5 orders.,"SELECT user_id, COUNT(*) AS num_orders FROM orders GROUP BY user_id HAVING COUNT(*) > 5;"
37,Show products whose total ordered quantity is greater than 100.,"SELECT product_id, SUM(quantity) AS total_quantity FROM orders GROUP BY product_id HAVING SUM(quantity) > 100;"
38,Show the 10 most recently created orders.,"SELECT order_id, user_id, product_id, quantity, order_date FROM orders ORDER BY order_date DESC LIMIT 10;"
39,Show the 5 cheapest products.,"SELECT product_id, name, price FROM products ORDER BY price ASC LIMIT 5;"
40,Show the 5 most expensive products.,"SELECT product_id, name, price FROM products ORDER BY price DESC LIMIT 5;"
41,Find users whose name starts with 'A'.,"SELECT user_id, name, email FROM users WHERE name LIKE 'A%';"
42,Find products whose name contains the word 'phone'.,"SELECT product_id, name, price FROM products WHERE name LIKE '%phone%';"
43,Show users who signed up in 2024.,"SELECT user_id, name, email, signup_date FROM users WHERE signup_date >= '2024-01-01' AND signup_date < '2025-01-01';"
44,Show orders placed in the last 30 days.,"SELECT order_id, user_id, product_id, quantity, order_date FROM orders WHERE order_date >= DATE('now', '-30 days');"
45,Show products that have been ordered at least once.,"SELECT product_id, name FROM products WHERE product_id IN (SELECT DISTINCT product_id FROM orders);"
46,Show users who have made at least one payment.,"SELECT user_id, name FROM users WHERE user_id IN (SELECT DISTINCT o.user_id FROM orders o JOIN payments pay ON o.order_id = pay.order_id);"
47,Show the product with the highest revenue.,"SELECT product_id, name, total_revenue FROM (SELECT p.product_id, p.name, SUM(o.quantity * p.price) AS total_revenue FROM orders o JOIN products p ON o.product_id = p.product_id GROUP BY p.product_id, p.name) AS t ORDER BY total_revenue DESC LIMIT 1;"
48,Show the total revenue per country.,"SELECT u.country, SUM(o.quantity * p.price) AS total_revenue FROM users u JOIN orders o ON u.user_id = o.user_id JOIN products p ON o.product_id = p.product_id GROUP BY u.country;"
49,Show the top 3 countries by number of orders.,"SELECT u.country, COUNT(o.order_id) AS num_orders FROM users u JOIN orders o ON u.user_id = o.user_id GROUP BY u.country ORDER BY num_orders DESC LIMIT 3;"
50,Show the average product price per category.,"SELECT category, AVG(price) AS avg_price FROM products GROUP BY category;"
51,Show the number of distinct users who placed orders in 2024.,SELECT COUNT(DISTINCT user_id) AS num_users FROM orders WHERE order_date >= '2024-01-01' AND order_date < '2025-01-01';
52,Show each user and the date of their first order.,"SELECT u.user_id, u.name, MIN(o.order_date) AS first_order_date FROM users u JOIN orders o ON u.user_id = o.user_id GROUP BY u.user_id, u.name;"
53,Show each user and the date of their most recent order.,"SELECT u.user_id, u.name, MAX(o.order_date) AS last_order_date FROM users u JOIN orders o ON u.user_id = o.user_id GROUP BY u.user_id, u.name;"
54,Show the total revenue from cancelled orders.,SELECT SUM(o.quantity * p.price) AS cancelled_revenue FROM orders o JOIN products p ON o.product_id = p.product_id WHERE o.status = 'CANCELLED';
55,Show the number of completed orders per user.,"SELECT user_id, COUNT(*) AS completed_orders FROM orders WHERE status = 'COMPLETED' GROUP BY user_id;"
56,Show the average payment amount per payment method.,"SELECT payment_method, AVG(amount) AS avg_amount FROM payments GROUP BY payment_method;"
57,Show the total amount paid per day.,"SELECT payment_date, SUM(amount) AS total_amount FROM payments GROUP BY payment_date;"
58,Show the largest single payment ever made.,"SELECT payment_id, order_id, amount, payment_method, payment_date FROM payments ORDER BY amount DESC LIMIT 1;"
59,Show users and how many different products they have ordered.,"SELECT u.user_id, u.name, COUNT(DISTINCT o.product_id) AS num_products FROM users u JOIN orders o ON u.user_id = o.user_id GROUP BY u.user_id, u.name;"
60,Show products and how many different users ordered them.,"SELECT p.product_id, p.name, COUNT(DISTINCT o.user_id) AS num_users FROM products p JOIN orders o ON p.product_id = o.product_id GROUP BY p.product_id, p.name;"
61,"Show all orders with their payment status, including orders that have no payment yet.","SELECT o.order_id, o.user_id, o.product_id, o.quantity, o.status, pay.amount, pay.payment_date FROM orders o LEFT JOIN payments pay ON o.order_id = pay.order_id;"
